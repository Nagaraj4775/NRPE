{#
Custome parameters for objects
#}
{% macro nagios_extra(configuration) -%}
{% for parameter, value in configuration.iteritems() %}
    {{ parameter.ljust(31) }} {{ value }}
{% endfor %}
{%- endmacro %}
{# # # #  File begins # # # #}
# {{ ansible_managed }}

#
# Template for the host configuration
#
define host {
    name                            host-{{ ansible_hostname }}
    hostgroups                      {{ memberof | join(',') }}
    register                        0
{{ nagios_extra(nagios_host_defaults) }}
}

#
# Template for all the services on {{ ansible_hostname }}
#
define service {
    name                            service-{{ ansible_hostname }}
    register                        0
    servicegroups                   {% for group in memberof if group not in (nagios_group_services | map(attribute="name")) %}{{ group }}{% if not loop.last %},{% endif %}{% endfor %}

{{ nagios_extra(nagios_service_defaults) }}
}

#
# Template for all the service dependencies on {{ ansible_hostname }}
#
define servicedependency {
    name                            servicedependency-{{ ansible_hostname }}
    register                        0
{{ nagios_extra(nagios_dependency_defaults) }}
}
